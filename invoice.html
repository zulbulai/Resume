<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zulbulai Invoice Generator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 10px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            overflow: hidden;
        }

        .form-section {
            padding: 30px;
            background: #f8f9fa;
            border-bottom: 3px solid #ff6b35;
        }

        .form-section h1 {
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 28px;
        }

        .form-section p {
            color: #7f8c8d;
            margin-bottom: 25px;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group label {
            font-weight: 600;
            color: #34495e;
            margin-bottom: 8px;
            font-size: 14px;
        }

        .form-group input,
        .form-group select {
            padding: 12px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 6px;
            font-size: 15px;
            transition: all 0.3s;
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: #ff6b35;
            box-shadow: 0 0 0 3px rgba(255, 107, 53, 0.1);
        }

        .btn-group {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }

        .btn {
            flex: 1;
            padding: 14px 25px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-primary {
            background: #ff6b35;
            color: white;
        }

        .btn-primary:hover {
            background: #e55a28;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 107, 53, 0.3);
        }

        .btn-secondary {
            background: #3498db;
            color: white;
        }

        .btn-secondary:hover {
            background: #2980b9;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.3);
        }

        /* Invoice Preview Styles */
        #invoice-preview {
            padding: 50px;
            background: white;
            display: none;
        }

        .invoice-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 3px solid #ff6b35;
        }

        .company-info {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .company-logo {
            width: 80px;
            height: 80px;
            object-fit: contain;
        }

        .company-details h2 {
            color: #2c3e50;
            font-size: 32px;
            margin-bottom: 10px;
        }

        .company-details p {
            color: #7f8c8d;
            line-height: 1.6;
            margin: 3px 0;
        }

        .invoice-title {
            text-align: right;
        }

        .invoice-title h1 {
            color: #ff6b35;
            font-size: 48px;
            margin-bottom: 10px;
        }

        .invoice-meta {
            color: #2c3e50;
            font-size: 14px;
        }

        .invoice-meta strong {
            color: #34495e;
        }

        .invoice-body {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 40px;
        }

        .section-box {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #ff6b35;
        }

        .section-box h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 18px;
        }

        .section-box p {
            color: #34495e;
            line-height: 1.8;
            margin: 5px 0;
        }

        .invoice-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 30px;
        }

        .invoice-table thead {
            background: #2c3e50;
            color: white;
        }

        .invoice-table th {
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }

        .invoice-table td {
            padding: 15px;
            border-bottom: 1px solid #e0e0e0;
        }

        .invoice-table tbody tr:hover {
            background: #f8f9fa;
        }

        .text-right {
            text-align: right;
        }

        .totals-section {
            display: flex;
            justify-content: flex-end;
            margin-bottom: 40px;
        }

        .totals-box {
            min-width: 350px;
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            border: 2px solid #e0e0e0;
        }

        .total-row {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            color: #34495e;
        }

        .total-row.final {
            border-top: 3px solid #ff6b35;
            margin-top: 10px;
            padding-top: 15px;
            font-size: 20px;
            font-weight: 700;
            color: #2c3e50;
        }

        .invoice-footer {
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
            margin-top: 50px;
            padding-top: 30px;
            border-top: 2px solid #e0e0e0;
        }

        .payment-info {
            flex: 1;
        }

        .payment-info h4 {
            color: #2c3e50;
            margin-bottom: 15px;
        }

        .payment-info p {
            color: #7f8c8d;
            line-height: 1.8;
            margin: 5px 0;
        }

        .qr-code {
            width: 150px;
            height: 150px;
            object-fit: contain;
            margin-top: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            padding: 10px;
            background: white;
        }

        .signature-section {
            text-align: right;
            display: flex;
            flex-direction: column;
            align-items: flex-end;
        }

        .signature-image {
            width: 180px;
            height: 80px;
            object-fit: contain;
            margin-bottom: 10px;
        }

        .signature-line {
            width: 200px;
            border-top: 2px solid #2c3e50;
            padding-top: 10px;
            font-weight: 600;
            color: #2c3e50;
            text-align: center;
        }

        .image-error {
            color: #e74c3c;
            font-size: 12px;
            font-style: italic;
        }

        @media print {
            body {
                background: white;
                padding: 0;
            }

            .form-section {
                display: none;
            }

            #invoice-preview {
                display: block !important;
            }
        }

        @media (max-width: 768px) {
            .invoice-header {
                flex-direction: column;
                gap: 20px;
            }

            .invoice-title {
                text-align: left;
            }

            .invoice-body {
                grid-template-columns: 1fr;
            }

            .invoice-footer {
                flex-direction: column;
                gap: 30px;
                align-items: flex-start;
            }

            .signature-section {
                align-items: flex-start;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Form Section -->
        <div class="form-section">
            <h1>üìÑ Invoice Generator - Zulbulai</h1>
            <p>Customer ‡§î‡§∞ Subscription details ‡§≠‡§∞‡•á‡§Ç</p>

            <div class="form-grid">
                <div class="form-group">
                    <label for="customerName">Customer Name *</label>
                    <input type="text" id="customerName" placeholder="‡§™‡•Ç‡§∞‡§æ ‡§®‡§æ‡§Æ" required>
                </div>

                <div class="form-group">
                    <label for="customerEmail">Email Address *</label>
                    <input type="email" id="customerEmail" placeholder="email@example.com" required>
                </div>

                <div class="form-group">
                    <label for="customerPhone">Phone Number *</label>
                    <input type="tel" id="customerPhone" placeholder="10-digit number" required>
                </div>

                <div class="form-group">
                    <label for="subscriptionPlan">Subscription Plan *</label>
                    <select id="subscriptionPlan" required>
                        <option value="">-- Select Plan --</option>
                        <option value="monthly" data-amount="49">Monthly - ‚Çπ49</option>
                        <option value="quarterly" data-amount="99">Quarterly - ‚Çπ99</option>
                        <option value="annual" data-amount="299">Annual - ‚Çπ299</option>
                    </select>
                </div>
            </div>

            <div class="btn-group">
                <button class="btn btn-primary" onclick="generateInvoice()">‚ú® Generate Invoice</button>
                <button class="btn btn-secondary" onclick="downloadPDF()">üì• Download PDF</button>
            </div>
        </div>

        <!-- Invoice Preview Section -->
        <div id="invoice-preview">
            <div class="invoice-header">
                <div class="company-info">
                    <img id="companyLogo" class="company-logo" alt="Company Logo">
                    <div class="company-details">
                        <h2>ZULBULAI</h2>
                        <p>üìß zulbulai@gmail.com</p>
                        <p>üìû 6387617678</p>
                        <p>üìç Sahibabad, New Delhi,<br>Ghaziabad, Uttar Pradesh 201005</p>
                    </div>
                </div>

                <div class="invoice-title">
                    <h1>INVOICE</h1>
                    <div class="invoice-meta">
                        <p><strong>Invoice #:</strong> <span id="invoiceNumber"></span></p>
                        <p><strong>Date:</strong> <span id="invoiceDate"></span></p>
                    </div>
                </div>
            </div>

            <div class="invoice-body">
                <div class="section-box">
                    <h3>Bill To:</h3>
                    <p><strong id="displayName"></strong></p>
                    <p id="displayEmail"></p>
                    <p id="displayPhone"></p>
                </div>

                <div class="section-box">
                    <h3>Payment Details:</h3>
                    <p><strong>UPI ID:</strong> Canvapro@upi</p>
                    <p><strong>Method:</strong> Digital Payment</p>
                    <img id="qrCode" class="qr-code" alt="Payment QR Code">
                </div>
            </div>

            <table class="invoice-table">
                <thead>
                    <tr>
                        <th>SL NO.</th>
                        <th>Description</th>
                        <th>Duration</th>
                        <th class="text-right">Amount</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>1</td>
                        <td id="planDescription">Subscription Plan</td>
                        <td id="planDuration"></td>
                        <td class="text-right" id="planAmount">‚Çπ0</td>
                    </tr>
                </tbody>
            </table>

            <div class="totals-section">
                <div class="totals-box">
                    <div class="total-row">
                        <span>Subtotal:</span>
                        <span id="subtotal">‚Çπ0</span>
                    </div>
                    <div class="total-row">
                        <span>Tax (0%):</span>
                        <span>‚Çπ0</span>
                    </div>
                    <div class="total-row final">
                        <span>Total Amount:</span>
                        <span id="totalAmount">‚Çπ0</span>
                    </div>
                </div>
            </div>

            <div class="invoice-footer">
                <div class="payment-info">
                    <h4>üôè Thank You for Your Business!</h4>
                    <p>Payment ‡§ï‡•ã UPI ID: <strong>Canvapro@upi</strong> ‡§™‡§∞ ‡§ï‡§∞‡•á‡§Ç</p>
                    <p>‡§ï‡§ø‡§∏‡•Ä ‡§≠‡•Ä query ‡§ï‡•á ‡§≤‡§ø‡§è ‡§π‡§Æ‡•á‡§Ç contact ‡§ï‡§∞‡•á‡§Ç</p>
                </div>

                <div class="signature-section">
                    <img id="signatureImage" class="signature-image" alt="Authorized Signature">
                    <div class="signature-line">
                        Authorized Signature<br>
                        <strong>Zulbulai</strong>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <script>
        // Image loading function
        function loadImages() {
            // Load logo
            const logo = document.getElementById('companyLogo');
            logo.src = './logo.png';
            logo.onerror = function() {
                // Hide logo if not found
                this.style.display = 'none';
            };

            // Load signature
            const signature = document.getElementById('signatureImage');
            signature.src = './signature.png';
            signature.onerror = function() {
                // Hide signature image if not found
                this.style.display = 'none';
            };

            // Load QR code
            const qr = document.getElementById('qrCode');
            qr.src = './qr.png';
            qr.onerror = function() {
                // Hide QR if not found
                this.style.display = 'none';
            };
        }

        // Load images when page loads
        window.addEventListener('DOMContentLoaded', loadImages);

        // Initialize invoice counter
        if (!localStorage.getItem('invoiceCounter')) {
            localStorage.setItem('invoiceCounter', '1000');
        }

        function generateInvoice() {
            // Get form values
            const name = document.getElementById('customerName').value.trim();
            const email = document.getElementById('customerEmail').value.trim();
            const phone = document.getElementById('customerPhone').value.trim();
            const planSelect = document.getElementById('subscriptionPlan');
            const planValue = planSelect.value;

            // Validation
            if (!name || !email || !phone || !planValue) {
                alert('‡§ï‡•É‡§™‡§Ø‡§æ ‡§∏‡§≠‡•Ä fields ‡§≠‡§∞‡•á‡§Ç! ‚ùå');
                return;
            }

            // Email validation
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(email)) {
                alert('Valid email address ‡§°‡§æ‡§≤‡•á‡§Ç! ‚ùå');
                return;
            }

            // Phone validation
            if (phone.length !== 10 || isNaN(phone)) {
                alert('Valid 10-digit phone number ‡§°‡§æ‡§≤‡•á‡§Ç! ‚ùå');
                return;
            }

            // Get plan details
            const selectedOption = planSelect.options[planSelect.selectedIndex];
            const amount = selectedOption.getAttribute('data-amount');
            const planText = selectedOption.text;

            let planName = '';
            let duration = '';

            switch(planValue) {
                case 'monthly':
                    planName = 'Monthly Subscription';
                    duration = '1 Month';
                    break;
                case 'quarterly':
                    planName = 'Quarterly Subscription';
                    duration = '3 Months';
                    break;
                case 'annual':
                    planName = 'Annual Subscription';
                    duration = '12 Months';
                    break;
            }

            // Update invoice
            let counter = parseInt(localStorage.getItem('invoiceCounter'));
            counter++;
            localStorage.setItem('invoiceCounter', counter.toString());

            document.getElementById('invoiceNumber').textContent = 'ZUL-' + counter;

            // Set date
            const today = new Date();
            const dateStr = today.toLocaleDateString('hi-IN', {
                day: '2-digit',
                month: 'short',
                year: 'numeric'
            });
            document.getElementById('invoiceDate').textContent = dateStr;

            // Set customer details
            document.getElementById('displayName').textContent = name;
            document.getElementById('displayEmail').textContent = 'üìß ' + email;
            document.getElementById('displayPhone').textContent = 'üìû ' + phone;

            // Set plan details
            document.getElementById('planDescription').textContent = planName;
            document.getElementById('planDuration').textContent = duration;
            document.getElementById('planAmount').textContent = '‚Çπ' + amount;
            document.getElementById('subtotal').textContent = '‚Çπ' + amount;
            document.getElementById('totalAmount').textContent = '‚Çπ' + amount;

            // Show invoice
            document.getElementById('invoice-preview').style.display = 'block';

            // Smooth scroll to invoice
            document.getElementById('invoice-preview').scrollIntoView({ 
                behavior: 'smooth',
                block: 'start'
            });

            alert('‚úÖ Invoice generated successfully!');
        }

        async function downloadPDF() {
            const invoicePreview = document.getElementById('invoice-preview');

            if (invoicePreview.style.display === 'none') {
                alert('‡§™‡§π‡§≤‡•á invoice generate ‡§ï‡§∞‡•á‡§Ç! ‚ö†Ô∏è');
                return;
            }

            try {
                // Show loading
                const btn = event.target;
                const originalText = btn.textContent;
                btn.textContent = '‚è≥ Generating PDF...';
                btn.disabled = true;

                const canvas = await html2canvas(invoicePreview, {
                    scale: 2,
                    useCORS: true,
                    allowTaint: true,
                    logging: false,
                    backgroundColor: '#ffffff'
                });

                const imgData = canvas.toDataURL('image/png');
                const { jsPDF } = window.jspdf;
                const pdf = new jsPDF('p', 'mm', 'a4');

                const imgWidth = 210; // A4 width in mm
                const pageHeight = 297; // A4 height in mm
                const imgHeight = (canvas.height * imgWidth) / canvas.width;

                let heightLeft = imgHeight;
                let position = 0;

                pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                heightLeft -= pageHeight;

                // Add new page if content is too long
                while (heightLeft >= 0) {
                    position = heightLeft - imgHeight;
                    pdf.addPage();
                    pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                    heightLeft -= pageHeight;
                }

                const invoiceNum = document.getElementById('invoiceNumber').textContent;
                const customerName = document.getElementById('displayName').textContent;
                const fileName = `Invoice_${invoiceNum}_${customerName.replace(/\s+/g, '_')}.pdf`;

                pdf.save(fileName);

                // Reset button
                btn.textContent = originalText;
                btn.disabled = false;

                alert('‚úÖ PDF downloaded successfully!');
            } catch (error) {
                console.error('PDF generation error:', error);
                alert('PDF generation ‡§Æ‡•á‡§Ç error ‡§Ü‡§Ø‡§æ‡•§ ‡§´‡§ø‡§∞ ‡§∏‡•á try ‡§ï‡§∞‡•á‡§Ç‡•§ ‚ùå');
                event.target.textContent = 'üì• Download PDF';
                event.target.disabled = false;
            }
        }
    </script>
</body>
</html>
